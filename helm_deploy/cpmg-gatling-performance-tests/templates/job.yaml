apiVersion: batch/v1
kind: Job
metadata:
  name: "cpmg-gatling-performance-tests"
spec:
  template:
    spec:
      containers:
      - name: "cpmg-gatling-performance-tests"
        image: "{{ .Values.image.repository }}:{{ .Values.image.tag }}"
        env:
          - name: S3_BUCKET_NAME
            valueFrom:
              secretKeyRef:
                name: perf-test-data-s3-credentials
                key: BUCKET_NAME
          - name: AWS_ACCESS_KEY_ID
            valueFrom:
              secretKeyRef:
                name: perf-test-data-s3-credentials
                key: ACCESS_KEY_ID
          - name: AWS_SECRET_ACCESS_KEY
            valueFrom:
              secretKeyRef:
                name: perf-test-data-s3-credentials
                key: SECRET_ACCESS_KEY

      restartPolicy: Never
  backoffLimit: 1
